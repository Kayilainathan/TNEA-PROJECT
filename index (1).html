<!DOCTYPE html>
<html>
<head>
  <title>TNEA Choice List Creator</title>
</head>
<body>
  <h1>TNEA Choice List Creator</h1>

  <form id="choiceForm">
    <label for="name">Enter your name:</label><br>
    <input type="text" id="name" name="name" required><br><br>

    <label for="cutoff">Enter your Cut off:</label><br>
    <input type="number" id="cutoff" name="cutoff" step="0.1" required><br><br>

    <label for="choices">Enter the number of choices:</label><br>
    <input type="number" id="choices" name="choices" min="1" required><br><br>

    <div id="choiceInputs">
      </div>

    <button type="button" onclick="addChoice()">Add Choice</button><br><br>

    <button type="submit">Generate Choice List</button>
  </form>

  <div id="choiceList"></div>
  <div id="downloadLink"></div>

  <script>
    let choiceCount = 0;

    function addChoice() {
      choiceCount++;
      const choiceInputs = document.getElementById('choiceInputs');
      const newChoice = `
        <label for="code${choiceCount}">College Code:</label><br>
        <input type="number" id="code${choiceCount}" name="code${choiceCount}" required><br><br>

        <label for="department${choiceCount}">Department:</label><br>
        <input type="text" id="department${choiceCount}" name="department${choiceCount}" required><br><br>
      `;
      choiceInputs.innerHTML += newChoice;
    }

    const form = document.getElementById('choiceForm');
    form.addEventListener('submit', (event) => {
      event.preventDefault();

      const name = document.getElementById('name').value;
      const cutoff = document.getElementById('cutoff').value;
      const numChoices = parseInt(document.getElementById('choices').value);

      const choices = [];
      for (let i = 1; i <= numChoices; i++) {
        const code = parseInt(document.getElementById(`code${i}`).value);
        const department = document.getElementById(`department${i}`).value;
        choices.push({ code: code, department: department });
      }

      generateChoiceList(name, cutoff, choices);
    });

    function generateChoiceList(name, cutoff, choices) {
      const choiceList = document.getElementById('choiceList');
      const downloadLink = document.getElementById('downloadLink');
      choiceList.innerHTML = `
        <h2>Your Choice List</h2>
        <p><strong>Name:</strong> ${name}</p>
        <p><strong>Cut off:</strong> ${cutoff}</p>
        <p><strong>No of Choices:</strong> ${choices.length}</p>

        <table>
          <thead>
            <tr>
              <th>S.NO</th>
              <th>COLLEGE CODE</th>
              <th>COLLEGE NAME</th>
              <th>DEPARTMENT</th>
            </tr>
          </thead>
          <tbody>
          </tbody>
        </table>
      `;

      const tableBody = choiceList.querySelector('tbody');
      for (let i = 0; i < choices.length; i++) {
        const code = choices[i].code;
        const department = choices[i].department;
        const collegeName = getCollegeName(code);
        const row = tableBody.insertRow();
        row.insertCell().textContent = i + 1;
        row.insertCell().textContent = code;
        row.insertCell().textContent = collegeName;
        row.insertCell().textContent = department;
      }

      // Logic to display possible choices based on cutoff
      // You can implement this based on the logic from your previous code

      // Create a data URL for the choice list
      const choiceData = generateChoiceListData(name, cutoff, choices);
      const downloadUrl = `data:text/plain;charset=utf-8,${encodeURIComponent(choiceData)}`;

      downloadLink.innerHTML = `
        <a href="${choice_list.txt}" download="choice_list.txt">Download Choice List</a>
      `;
    }

    function getCollegeName(code) {
      // This function is a simplified version of your original code 
      // It assumes a mapping between college code and name is available
      // You can replace this with your own logic for finding the college name
      const collegeMap = {
        1: "CEG",
        4: "MIT",
        1315: "SSN",
        1399: "CIT",
        2006: "PSG",
        1211: "REC",
        1219: "SVCE",
        1419: "Sri Sairam",
        1216: "Saveetha",
        1317: "St.Joseph",
        1113: "RMK",
        1112: "RMD",
        1324: "Sri Sairam Institute",
        1450: "Loyola ICAM",
        1210: "PANIMALAR",
        2005: "GCT Coimbatore",
        2377: "PSG iTECH",
        1422: "SRM Valliammai",
        2718: "SRI KRISHNA",
        2739: "SRI ESWAR",
        5008: "THIAGARAJAR",
        2007: "CIT Coimbatore"
      };
      return collegeMap[code] || "-";
    }

    function generateChoiceListData(name, cutoff, choices) {
      let choiceData = `\t\t\t\tTNEA CHOICE LIST\n\n`;
      choiceData += `NAME : ${name}\n`;
      choiceData += `Cut off : ${cutoff}\n`;
      choiceData += `No of Choices = ${choices.length}\n\n`;
      choiceData += `S.NO        COLLEGE CODE       COLLEGE NAME                DEPARTMENT\n`;
      choiceData += `_____________________________________________________________________\n`;

      for (let i = 0; i < choices.length; i++) {
        const code = choices[i].code;
        const department = choices[i].department;
        const collegeName = getCollegeName(code);
        choiceData += `${i + 1}        ${code}                 ${collegeName}                         ${department}\n`;
        choiceData += `_____________________________________________________________________\n`;
      }

      // Logic to include possible choices based on cutoff
      // You can implement this based on the logic from your previous code

      choiceData += `\n\tThank you ${name} for using choice list creater - coded by KAYILAINATHAN\n\n`;
      choiceData += `\t\t\tTOP COLLEGE LIST\n`;
      // Add college list here

      choiceData += `\n\n\t\t\t\t\t\t\t\t\tkayilainathan.choicelist.c.code`;
      return choiceData;
    }

  </script>
</body>
</html>